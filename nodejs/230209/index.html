<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://cdn.socket.io/4.6.0/socket.io.min.js"
      integrity="sha384-c79GN5VsunZvi+Q/WObgk2in0CbZsHnjEqvFxC5DxHn9lTfNce2WW6h2pH6u/kF+"
      crossorigin="anonymous"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"
    ></script>
    <title>Socket</title>
    <style>
      @font-face {
        font-family: "SUIT-Regular";
        src: url("https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Regular.woff2")
          format("woff2");
        font-weight: normal;
        font-style: normal;
      }
      body {
        font-family: "SUIT-Regular";
      }
      .chat {
        width: 300px;
        height: 500px;
        background-color: #f4f4f4;
      }
      .notice {
        text-align: center;
        padding-top: 5px;
        font-size: 12px;
      }
      .me {
        width: auto;
        height: auto;
        background-color: rgb(255, 119, 119);
        text-align: center;
        padding: 5px 0px;
        border-radius: 5%;
        float: right;
        display: block;
        margin: 10px 10px 0 0;
        padding: 5px 10px;
        clear: both;
      }
      .you {
        clear: both;
        padding: 10px 0 0 10px;
      }
      .you_msg {
        width: auto;
        height: auto;
        background-color: #dcdcdc;
        text-align: center;
        padding: 5px 10px;
        border-radius: 5%;
        display: inline-block;
      }
      .input_msg {
        width: 300px;
      }
    </style>
  </head>
  <body>
    <!-- 채팅 영역 -->
    <div id="chat" class="chat">
      <!-- 채팅 접속 알림 -->
      <!-- <div class="notice">000님이 입장하였습니다.</div> -->
      <!-- 채팅 메세지 -->
      <!-- <div class="me">안녕</div>
      <div class="you">
        <div class="you_msg">반가워</div>
      </div> -->
    </div>
    <!-- 메세지 전송 영역 -->
    <div class="input-group input_msg">
      <select
        class="form-select-sm rounded-0"
        style="border: 1px solid #dbdbdb"
      >
        <option selected>전체</option>
        <option value="홍길동">홍길동</option>
        <option value="아무개">아무개</option>
      </select>
      <input
        id="msg"
        type="text"
        class="form-control"
        placeholder="메세지를 입력하세요."
        aria-describedby="button-addon2"
      />
      <button
        id="sendBtn"
        class="btn btn btn-outline-secondary rounded-0"
        type="button"
        id="button-addon2"
        onclick="send()"
      >
        전송
      </button>
    </div>
    <script>
      // 소켓 연결
      let socket = io.connect();
      let chat = document.getElementById("chat");
      let notice = document.createElement("div");
      // socket.on("connect", () => console.log("server connected"));
      socket.on("notice", (id) => {
        notice.classList.add("notice");
        notice.innerText = id;
        chat.appendChild(notice);
      });

      //enter 클릭 시, 메세지 전송
      var inputCk = document.getElementById("msg");
      inputCk.addEventListener("keyup", (e) => {
        if (e.keyCode === 13) {
          e.preventDefault();
          document.getElementById("sendBtn").click();
        }
      });

      //button 클릭 시, 이벤트
      const send = () => {
        let message = document.getElementById("msg").value;
        let msg = document.createElement("div");
        let node = document.createTextNode(message);
        msg.classList.add("me");
        msg.appendChild(node);
        chat.appendChild(msg);
        document.getElementById("msg").value = "";
      };
    </script>
  </body>
</html>
